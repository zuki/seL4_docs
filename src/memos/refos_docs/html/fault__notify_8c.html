<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RefOS: apps/file_server/src/dispatchers/fault_notify.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RefOS
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Multi-server operating system on seL4</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('fault__notify_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fault_notify.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Handles process server client notifications.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="refos_8h_source.html">refos/refos.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="error_8h_source.html">refos/error.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="share_8h_source.html">refos/share.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="proc__common_8h_source.html">refos-rpc/proc_common.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="data__client_8h_source.html">refos-rpc/data_client.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="data__client__helper_8h_source.html">refos-rpc/data_client_helper.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="serv__connect_8h_source.html">refos-util/serv_connect.h</a>&gt;</code><br />
<code>#include &lt;utils/arith.h&gt;</code><br />
<code>#include &quot;<a class="el" href="file__server_2src_2dispatchers_2dispatch_8h_source.html">dispatch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="file__server_2src_2state_8h_source.html">../state.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="file__server_2src_2badge_8h_source.html">../badge.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaedc0c7dca55ab5f3346bc0878d69baa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fault__notify_8c.html#aaedc0c7dca55ab5f3346bc0878d69baa">handle_fileserver_fault</a> (struct <a class="el" href="structproc__notification.html">proc_notification</a> *notification)</td></tr>
<tr class="memdesc:aaedc0c7dca55ab5f3346bc0878d69baa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles client page fault notifications.  <a href="fault__notify_8c.html#aaedc0c7dca55ab5f3346bc0878d69baa">More...</a><br /></td></tr>
<tr class="separator:aaedc0c7dca55ab5f3346bc0878d69baa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c9cb5120d621cdd10e7bacf53a570e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fault__notify_8c.html#a28c9cb5120d621cdd10e7bacf53a570e">handle_fileserver_content_init</a> (struct <a class="el" href="structproc__notification.html">proc_notification</a> *notification)</td></tr>
<tr class="memdesc:a28c9cb5120d621cdd10e7bacf53a570e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles client content init notifications.  <a href="fault__notify_8c.html#a28c9cb5120d621cdd10e7bacf53a570e">More...</a><br /></td></tr>
<tr class="separator:a28c9cb5120d621cdd10e7bacf53a570e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b7e5511dd5ab142f76b0e2896dc0a4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fault__notify_8c.html#ae8b7e5511dd5ab142f76b0e2896dc0a4">handle_fileserver_death_notification</a> (struct <a class="el" href="structproc__notification.html">proc_notification</a> *notification)</td></tr>
<tr class="memdesc:ae8b7e5511dd5ab142f76b0e2896dc0a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles client death notifications.  <a href="fault__notify_8c.html#ae8b7e5511dd5ab142f76b0e2896dc0a4">More...</a><br /></td></tr>
<tr class="separator:ae8b7e5511dd5ab142f76b0e2896dc0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad692cb6c1b9db0949b774f1700fa6eb7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fault__notify_8c.html#ad692cb6c1b9db0949b774f1700fa6eb7">dispatch_notification</a> (<a class="el" href="serv__common_8h.html#a31b2623867d2146df7bc0377664561e9">srv_msg_t</a> *<a class="el" href="muse_8c.html#a2be9fd1bd420b11f443b4b54d13f2b4d">m</a>)</td></tr>
<tr class="memdesc:ad692cb6c1b9db0949b774f1700fa6eb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notification dispatcher, responsible for dispatching async notifications.  <a href="fault__notify_8c.html#ad692cb6c1b9db0949b774f1700fa6eb7">More...</a><br /></td></tr>
<tr class="separator:ad692cb6c1b9db0949b774f1700fa6eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handles process server client notifications. </p>
<p>This module is responsible for handling any process server notifications, including client page faults (when acting as pager), dataspace content initialisation calls, and client death notification. Notifications use asynchronous one-way ring buffers, operating on top of an anonymous memory dataspace (ie. the notification buffer). </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad692cb6c1b9db0949b774f1700fa6eb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad692cb6c1b9db0949b774f1700fa6eb7">&#9670;&nbsp;</a></span>dispatch_notification()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dispatch_notification </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="serv__common_8h.html#a31b2623867d2146df7bc0377664561e9">srv_msg_t</a> *&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Notification dispatcher, responsible for dispatching async notifications. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>The fileserver message info struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DISPATCH_SUCCESS if success, DISPATCHER_ERROR of and error occured, DISPATCH_PASS if the message is not a async notification. </dd></dl>

</div>
</div>
<a id="a28c9cb5120d621cdd10e7bacf53a570e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c9cb5120d621cdd10e7bacf53a570e">&#9670;&nbsp;</a></span>handle_fileserver_content_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_fileserver_content_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structproc__notification.html">proc_notification</a> *&#160;</td>
          <td class="paramname"><em>notification</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles client content init notifications. </p>
<p>Handles dataspace content init notifications from another dataserver. When we act as a data provider, the external dataserver (eg. process server for anon memory) notifies us with this notification for us to provide the content for it. We find the content that was asked for, and reply to the notification with data_provide_data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">notification</td><td>Structure containing the notification message, read from the notification ring buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DISPATCH_SUCCESS if success, DISPATCHER_ERROR otherwise. </dd></dl>

</div>
</div>
<a id="ae8b7e5511dd5ab142f76b0e2896dc0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b7e5511dd5ab142f76b0e2896dc0a4">&#9670;&nbsp;</a></span>handle_fileserver_death_notification()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_fileserver_death_notification </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structproc__notification.html">proc_notification</a> *&#160;</td>
          <td class="paramname"><em>notification</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles client death notifications. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">notification</td><td>Structure containing the notification message, read from the notification ring buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DISPATCH_SUCCESS if success, DISPATCHER_ERROR otherwise. </dd></dl>

</div>
</div>
<a id="aaedc0c7dca55ab5f3346bc0878d69baa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaedc0c7dca55ab5f3346bc0878d69baa">&#9670;&nbsp;</a></span>handle_fileserver_fault()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_fileserver_fault </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structproc__notification.html">proc_notification</a> *&#160;</td>
          <td class="paramname"><em>notification</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles client page fault notifications. </p>
<p>This function handles client page fault notifications from the process server. When we act as the pager, the process server delegates all page faults to us via this notification. We then choose a page to map, and map it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">notification</td><td>Structure containing the notification message, read from the notification ring buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DISPATCH_SUCCESS if success, DISPATCHER_ERROR otherwise. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_9654b8d08f4bba4e84b362c5fd320bee.html">apps</a></li><li class="navelem"><a class="el" href="dir_2f486bb11de8b95608ddad771f90f4ee.html">file_server</a></li><li class="navelem"><a class="el" href="dir_d0265948ecafbf9659da91b35639b300.html">src</a></li><li class="navelem"><a class="el" href="dir_b22c85dfd396ad8c10409f2eaac72aa4.html">dispatchers</a></li><li class="navelem"><a class="el" href="fault__notify_8c.html">fault_notify.c</a></li>
    <li class="footer">Generated on Sat Jun 10 2023 17:16:00 for RefOS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
