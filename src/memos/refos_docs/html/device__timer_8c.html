<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RefOS: apps/timer_server/src/device_timer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RefOS
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Multi-server operating system on seL4</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('device__timer_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">device_timer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>timer server timer device manager.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="stdio_8h_source.html">stdio.h</a>&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;autoconf.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;<a class="el" href="device__timer_8h_source.html">device_timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer__server_2src_2state_8h_source.html">state.h</a>&quot;</code><br />
<code>#include &lt;platsupport/timer.h&gt;</code><br />
<code>#include &lt;platsupport/plat/timer.h&gt;</code><br />
<code>#include &lt;<a class="el" href="dprintf_8h_source.html">refos-util/dprintf.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="device__io_8h_source.html">refos-util/device_io.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad836c08e2d75d5d34e9931ae1f35e46f"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#ad836c08e2d75d5d34e9931ae1f35e46f">timeserv_irq_callback_fn_t</a>) (void *cookie, uint32_t irq)</td></tr>
<tr class="separator:ad836c08e2d75d5d34e9931ae1f35e46f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab6cb988b77b8db45fe3de6c22b8e6c93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#ab6cb988b77b8db45fe3de6c22b8e6c93">timeserv_handle_irq</a> (uint32_t irq, <a class="el" href="device__timer_8c.html#ad836c08e2d75d5d34e9931ae1f35e46f">timeserv_irq_callback_fn_t</a> callback, void *cookie)</td></tr>
<tr class="separator:ab6cb988b77b8db45fe3de6c22b8e6c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f020bf68980cc2ea538b5b1ecc27340"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#a5f020bf68980cc2ea538b5b1ecc27340">reply_data_write</a> (void *rpc_userptr, int rpc___ret__)</td></tr>
<tr class="separator:a5f020bf68980cc2ea538b5b1ecc27340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e0627ede92a602f473a19d400d04a3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#a13e0627ede92a602f473a19d400d04a3">device_timer_update_sleepers</a> (struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *s)</td></tr>
<tr class="memdesc:a13e0627ede92a602f473a19d400d04a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Look at sleeper list and reply to any sleppers that have had their time requirements met.  <a href="device__timer_8c.html#a13e0627ede92a602f473a19d400d04a3">More...</a><br /></td></tr>
<tr class="separator:a13e0627ede92a602f473a19d400d04a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc8bb0ee0d762cbd7abd7c3f784aa80b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#acc8bb0ee0d762cbd7abd7c3f784aa80b">device_timer_handle_irq</a> (void *cookie, uint32_t irq)</td></tr>
<tr class="memdesc:acc8bb0ee0d762cbd7abd7c3f784aa80b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to handle GPT timer IRQs.  <a href="device__timer_8c.html#acc8bb0ee0d762cbd7abd7c3f784aa80b">More...</a><br /></td></tr>
<tr class="separator:acc8bb0ee0d762cbd7abd7c3f784aa80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6faea4416d2c58548e97f1d110eb3fea"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#a6faea4416d2c58548e97f1d110eb3fea">device_tick_handle_irq</a> (void *cookie, uint32_t irq)</td></tr>
<tr class="memdesc:a6faea4416d2c58548e97f1d110eb3fea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to handle waiter timer IRQs.  <a href="device__timer_8c.html#a6faea4416d2c58548e97f1d110eb3fea">More...</a><br /></td></tr>
<tr class="separator:a6faea4416d2c58548e97f1d110eb3fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19dcf03aa155b148fcda0f6703439a4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#aa19dcf03aa155b148fcda0f6703439a4">device_timer_init_rtc</a> (struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *s, <a class="el" href="device__io_8h.html#aa3e52a9d4ba481cbd78c5d4999614242">dev_io_ops_t</a> *io)</td></tr>
<tr class="separator:aa19dcf03aa155b148fcda0f6703439a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aa29b67e94a0bb97f6bea8eda127e41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#a6aa29b67e94a0bb97f6bea8eda127e41">device_timer_init</a> (struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *s, <a class="el" href="device__io_8h.html#aa3e52a9d4ba481cbd78c5d4999614242">dev_io_ops_t</a> *io)</td></tr>
<tr class="memdesc:a6aa29b67e94a0bb97f6bea8eda127e41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialies the timer device management module.  <a href="device__timer_8c.html#a6aa29b67e94a0bb97f6bea8eda127e41">More...</a><br /></td></tr>
<tr class="separator:a6aa29b67e94a0bb97f6bea8eda127e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46ae0dd2c5499b41803f08172e53297"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#aa46ae0dd2c5499b41803f08172e53297">device_timer_get_time</a> (struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *s)</td></tr>
<tr class="memdesc:aa46ae0dd2c5499b41803f08172e53297"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current time since epoch in nanoseconds.  <a href="device__timer_8c.html#aa46ae0dd2c5499b41803f08172e53297">More...</a><br /></td></tr>
<tr class="separator:aa46ae0dd2c5499b41803f08172e53297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2521dea399bcdc75dce6692f3d0f451"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#aa2521dea399bcdc75dce6692f3d0f451">device_timer_save_caller_as_waiter</a> (struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *s, struct <a class="el" href="structsrv__client.html">srv_client</a> *c, uint64_t waitTime)</td></tr>
<tr class="memdesc:aa2521dea399bcdc75dce6692f3d0f451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the current caller client's reply cap, and reply to it when its sleep time has passed.  <a href="device__timer_8c.html#aa2521dea399bcdc75dce6692f3d0f451">More...</a><br /></td></tr>
<tr class="separator:aa2521dea399bcdc75dce6692f3d0f451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0deeae50be1cccc01eca80d32f75132"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__timer_8c.html#ab0deeae50be1cccc01eca80d32f75132">device_timer_purge_client</a> (struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *client)</td></tr>
<tr class="memdesc:ab0deeae50be1cccc01eca80d32f75132"><td class="mdescLeft">&#160;</td><td class="mdescRight">Purge all weak references to client form waiting list. Used when client dies.  <a href="device__timer_8c.html#ab0deeae50be1cccc01eca80d32f75132">More...</a><br /></td></tr>
<tr class="separator:ab0deeae50be1cccc01eca80d32f75132"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>timer server timer device manager. </p>
<p>This module is responsible for managing the timer state. IT is a thin wrapper on top of the timer device drivers provided by libplatsupport.</p>
<p>When a client wants to sleep for some amount of seconds, we use seL4_CNode_SaveCaller in order to save its reply cap and reply to it when on the timer IRQ when its sleep period has expired. The timer module sets up frequent periodic timer IRQs in order to do this.</p>
<p>This approach is relatively inefficient as it results in a lot of IRQs and wasted time processing them. A better approach would be to set up one-shot IRQs at the exact time of the next waking client, allowing less IRQ overhead and much better sleep accuracy. This may be implemented in the near future, but for now spamming IRQs is a simple approach which works. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="ad836c08e2d75d5d34e9931ae1f35e46f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad836c08e2d75d5d34e9931ae1f35e46f">&#9670;&nbsp;</a></span>timeserv_irq_callback_fn_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* timeserv_irq_callback_fn_t) (void *cookie, uint32_t irq)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6faea4416d2c58548e97f1d110eb3fea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6faea4416d2c58548e97f1d110eb3fea">&#9670;&nbsp;</a></span>device_tick_handle_irq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void device_tick_handle_irq </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>irq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function to handle waiter timer IRQs. </p>
<p>Waiter-list IRQs happen very frequently, as opposed to the GPT overflow IRQs. This is used to wake up sleeping clients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cookie</td><td>The global timer state (struct <a class="el" href="structdevice__timer__state.html" title="Timer device state structure.">device_timer_state</a> *). </td></tr>
    <tr><td class="paramname">irq</td><td>The fired IRQ number. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa46ae0dd2c5499b41803f08172e53297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46ae0dd2c5499b41803f08172e53297">&#9670;&nbsp;</a></span>device_timer_get_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t device_timer_get_time </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current time since epoch in nanoseconds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The global timer device state structure (No ownership). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current time in nanoseconds. </dd></dl>

</div>
</div>
<a id="acc8bb0ee0d762cbd7abd7c3f784aa80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc8bb0ee0d762cbd7abd7c3f784aa80b">&#9670;&nbsp;</a></span>device_timer_handle_irq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void device_timer_handle_irq </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>irq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function to handle GPT timer IRQs. </p>
<p>GPT timer IRQs happen on GPT timer overflow. Note that the GPT device (used to get the actual time) may actually be the excat same device as the waiting-list IRQ generator device, depending on the platform.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cookie</td><td>The global timer state (struct <a class="el" href="structdevice__timer__state.html" title="Timer device state structure.">device_timer_state</a> *). </td></tr>
    <tr><td class="paramname">irq</td><td>The fired IRQ number. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6aa29b67e94a0bb97f6bea8eda127e41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aa29b67e94a0bb97f6bea8eda127e41">&#9670;&nbsp;</a></span>device_timer_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void device_timer_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="device__io_8h.html#aa3e52a9d4ba481cbd78c5d4999614242">dev_io_ops_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialies the timer device management module. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The global timer device state structure (No ownership). </td></tr>
    <tr><td class="paramname">io</td><td>The initialised device IO manager. (No ownership). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa19dcf03aa155b148fcda0f6703439a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19dcf03aa155b148fcda0f6703439a4">&#9670;&nbsp;</a></span>device_timer_init_rtc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void device_timer_init_rtc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="device__io_8h.html#aa3e52a9d4ba481cbd78c5d4999614242">dev_io_ops_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab0deeae50be1cccc01eca80d32f75132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0deeae50be1cccc01eca80d32f75132">&#9670;&nbsp;</a></span>device_timer_purge_client()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void device_timer_purge_client </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *&#160;</td>
          <td class="paramname"><em>client</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Purge all weak references to client form waiting list. Used when client dies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client</td><td>The dying client to be purged. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa2521dea399bcdc75dce6692f3d0f451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2521dea399bcdc75dce6692f3d0f451">&#9670;&nbsp;</a></span>device_timer_save_caller_as_waiter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int device_timer_save_caller_as_waiter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsrv__client.html">srv_client</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>waitTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the current caller client's reply cap, and reply to it when its sleep time has passed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The global timer device state structure (No ownership). </td></tr>
    <tr><td class="paramname">c</td><td>The client structure of the waiting client. </td></tr>
    <tr><td class="paramname">waitTime</td><td>The amount of time in nanoseconds that the client wishes to wait, relative to now. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESUCCESS if success, refos_err_t otherwise. </dd></dl>

</div>
</div>
<a id="a13e0627ede92a602f473a19d400d04a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13e0627ede92a602f473a19d400d04a3">&#9670;&nbsp;</a></span>device_timer_update_sleepers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void device_timer_update_sleepers </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdevice__timer__state.html">device_timer_state</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Look at sleeper list and reply to any sleppers that have had their time requirements met. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The timer global state structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5f020bf68980cc2ea538b5b1ecc27340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f020bf68980cc2ea538b5b1ecc27340">&#9670;&nbsp;</a></span>reply_data_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reply_data_write </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>rpc_userptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpc___ret__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab6cb988b77b8db45fe3de6c22b8e6c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6cb988b77b8db45fe3de6c22b8e6c93">&#9670;&nbsp;</a></span>timeserv_handle_irq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int timeserv_handle_irq </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="device__timer_8c.html#ad836c08e2d75d5d34e9931ae1f35e46f">timeserv_irq_callback_fn_t</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cookie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_9654b8d08f4bba4e84b362c5fd320bee.html">apps</a></li><li class="navelem"><a class="el" href="dir_19348ed8aa9f78945b3be3519338ae9b.html">timer_server</a></li><li class="navelem"><a class="el" href="dir_254817500612dd93c55b230acf173d97.html">src</a></li><li class="navelem"><a class="el" href="device__timer_8c.html">device_timer.c</a></li>
    <li class="footer">Generated on Sat Jun 10 2023 10:14:24 for RefOS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
